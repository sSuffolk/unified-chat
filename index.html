<!-- /index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>YouTube/Twitch Multi Chat üéÆ‚ú®</title>
  <link rel="icon" href="https://www.youtube.com/s/desktop/ffaa45ee/img/favicon_32.png" type="image/png">
  <style>
    :root{
      --vh: 1vh;                 /* updated via JS for iOS */
      --tab-h: 56px;             /* updated via JS after render */
      --bg-color:#f0f0f0; --header-bg:#333; --header-text:#fff; --input-border:#ccc;
      --button-primary-bg:#61afef; --button-primary-hover:#529dce;
      --button-secondary-bg:#98c379; --button-secondary-hover:#7ca95e;
      --notice-bg:#fff2a8; --notice-border:#e6d977; --notice-text:#333;
      --tab-bg:#444; --tab-active-bg:#61afef;
      --radius:12px;
    }

    /* Base layout uses real viewport units to avoid iOS URL-bar jump */
    html, body { height: calc(var(--vh) * 100); }
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      background:var(--bg-color);
      display:flex; flex-direction:column;
      min-height: calc(var(--vh) * 100);
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }

    /* Header */
    header{
      background:var(--header-bg); color:var(--header-text);
      padding:12px 10px;
      padding-top: calc(12px + env(safe-area-inset-top));
      box-shadow:0 2px 5px rgba(0,0,0,.2);
      position:relative; z-index:10;
    }
    header h2{ margin:0 0 8px; font-size:1.3rem; letter-spacing:.2px; }
    .controls{
      margin-bottom:8px; display:flex; justify-content:center; align-items:center; flex-wrap:wrap; gap:8px;
    }
    .controls input[type="text"]{
      flex:1 1 240px; max-width:420px; padding:12px 12px; border:1px solid var(--input-border);
      border-radius:8px; font-size:16px; box-sizing:border-box; /* 16px prevents iOS zoom */
      background:#fff;
    }
    .controls button{
      padding:12px 16px; font-size:16px; border:none; border-radius:10px;
      background:var(--button-primary-bg); color:var(--header-text); cursor:pointer;
      touch-action:manipulation;
    }
    .controls button:active{ transform:translateY(1px); }
    .controls button:hover{ background:var(--button-primary-hover); }

    .notice{
      background:var(--notice-bg); color:var(--notice-text);
      padding:10px; font-size:.92rem; border:1px solid var(--notice-border); border-radius:8px;
      margin:8px auto 0; max-width:680px; text-align:left;
    }

    .popouts{ margin-top:8px; display:flex; justify-content:center; flex-wrap:wrap; gap:8px; }
    .popouts button{
      padding:10px 14px; font-size:15px; border:none; border-radius:10px;
      background:var(--button-secondary-bg); color:var(--header-text); cursor:pointer; touch-action:manipulation;
    }
    .popouts button:active{ transform:translateY(1px); }
    .popouts button:hover{ background:var(--button-secondary-hover); }

    /* Bottom fixed tabs (thumb zone) */
    .tab-buttons{
      position:fixed; left:0; right:0; bottom:0;
      display:flex; justify-content:center; background:var(--tab-bg);
      padding-bottom: env(safe-area-inset-bottom);
      box-shadow:0 -2px 5px rgba(0,0,0,.15);
      z-index:20;
    }
    .tab-buttons button{
      flex:1; padding:14px 10px; border:none; background:transparent; color:var(--header-text);
      font-size:16px; cursor:pointer; touch-action:manipulation;
    }
    .tab-buttons button.active{ background:var(--tab-active-bg); }

    /* Chat area fills space above bottom tabs */
    .chat-wrapper{
      flex:1 1 auto; display:flex; overflow:hidden;
      min-height:0;
      padding-bottom: var(--tab-h);
    }
    .chat-container{
      width:100%; height:100%; display:none; flex-direction:column;
      min-height:0;
    }
    .chat-container.active{ display:flex; }
    .split{
      display:flex; flex-direction:column; width:100%; height:100%; gap:6px; padding:6px;
      min-height:0;
    }
    .single{ height:100%; min-height:0; padding:6px; }
    iframe{
      display:block; width:100%; border:0; background:#000; box-shadow:inset 0 0 5px rgba(0,0,0,.08); min-height:0;
    }
    .split iframe{ flex:1 1 0; }
    .single iframe{ height:100%; }

    /* Landscape: show both chats side-by-side */
    @media (orientation: landscape){
      .split{ flex-direction:row; }
    }

    /* Compact UI: hide header to maximize chat area (toggle with ‚öôÔ∏è) */
    body.compact header{ display:none; }
    body.compact .fab{ opacity:.9; }

    /* Floating settings button (always reachable) */
    .fab{
      position:fixed; top:calc(env(safe-area-inset-top) + 8px); right:8px; z-index:30;
      background:var(--tab-active-bg); color:#fff; border:none; border-radius:999px;
      padding:10px 12px; font-size:16px; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,.25);
      touch-action:manipulation;
    }
    .fab:active{ transform:translateY(1px); }

    /* Prevent body scroll bounce while interacting with iframes */
    body{ overscroll-behavior-y:none; }
  </style>
</head>
<body>
  <button id="toggle-compact" class="fab" aria-label="Toggle compact UI">‚öôÔ∏è</button>

  <header>
    <h2>YouTube/Twitch Multi Chat üéÆ‚ú®üí¨</h2>
    <div class="controls">
      <input id="twitch-input" type="text" placeholder="Enter Twitch channel name" aria-label="Twitch channel"/>
      <button id="save-twitch-btn">Save Twitch</button>
      <input id="yt-input" type="text" placeholder="Paste YouTube LIVE URL or 11-char ID" aria-label="YouTube Live Chat URL or ID"/>
      <button id="save-btn">Save YouTube</button>
    </div>
    <div class="notice">
      Heads up: some previews/local files block iframes. Host this (e.g., GitHub Pages) or use the popout buttons below. YouTube chat only loads when you‚Äôre actually live.
    </div>
    <div class="popouts">
      <button id="popout-twitch" aria-label="Launch Twitch chat in new window">Launch Twitch popout üöÄ</button>
      <button id="popout-youtube" aria-label="Launch YouTube chat in new window">Launch YouTube popout üöÄ</button>
    </div>
  </header>

  <div class="chat-wrapper">
    <div id="both" class="chat-container active">
      <div class="split">
        <iframe id="twitch-iframe" title="Twitch Chat"></iframe>
        <iframe id="youtube-iframe" title="YouTube Chat"></iframe>
      </div>
    </div>

    <div id="twitch" class="chat-container">
      <div class="single">
        <iframe id="twitch-only-iframe" title="Twitch Chat (Single View)"></iframe>
      </div>
    </div>

    <div id="youtube" class="chat-container">
      <div class="single">
        <iframe id="youtube-only-iframe" title="YouTube Chat (Single View)"></iframe>
      </div>
    </div>
  </div>

  <div id="tabs" class="tab-buttons" role="tablist" aria-label="Chat views">

