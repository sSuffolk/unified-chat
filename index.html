<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Stream Dash">
<title>Stream Dashboard</title>
<style>
  /* --- BASE STYLES --- */
  html, body { 
    margin: 0; padding: 0; 
    height: 100dvh; width: 100vw;
    background-color: #000;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", sans-serif;
    overflow: hidden;
    user-select: none;
    -webkit-user-select: none;
    -webkit-touch-callout: none;
    -webkit-tap-highlight-color: transparent;
    /* Prevent overscroll bounce */
    overscroll-behavior: none;
    position: fixed;
    touch-action: manipulation;
  }
  
  .container {
    display: flex;
    flex-direction: column;
    width: 100%; 
    height: 100%;
    box-sizing: border-box;
    /* iPhone safe areas */
    padding-top: max(env(safe-area-inset-top), 12px);
    padding-bottom: max(env(safe-area-inset-bottom), 8px);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
    position: relative;
  }

  iframe { 
    width: 100%; 
    height: 100%; 
    border: none; 
    display: block;
    background: #000;
  }

  /* --- TOP BAR (Below Dynamic Island) --- */
  .top-bar {
    position: absolute;
    top: max(env(safe-area-inset-top), 12px);
    left: 0; right: 0;
    height: 50px;
    background: linear-gradient(180deg, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.6) 70%, transparent 100%);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    box-sizing: border-box;
    z-index: 100;
    opacity: 1;
    transition: opacity 0.4s ease;
  }

  .top-bar.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .timer-section {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .live-indicator {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 59, 48, 0.2);
    border: 1px solid rgba(255, 59, 48, 0.4);
    padding: 6px 12px;
    border-radius: 8px;
  }

  .live-dot {
    height: 8px; width: 8px;
    background-color: #ff3b30;
    border-radius: 50%;
    animation: pulse 1.5s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; box-shadow: 0 0 8px #ff3b30; }
    50% { opacity: 0.6; box-shadow: 0 0 4px #ff3b30; }
  }

  .live-text {
    color: #ff453a;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 0.5px;
  }

  .stream-timer {
    color: #fff;
    font-size: 22px;
    font-weight: 600;
    font-variant-numeric: tabular-nums;
  }

  .clock {
    color: rgba(255,255,255,0.6);
    font-size: 15px;
    font-weight: 500;
    font-variant-numeric: tabular-nums;
  }

  /* --- SECTIONS --- */
  .chat-section {
    flex: 65; 
    position: relative;
    background: #000;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    transition: flex 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    min-height: 0;
  }

  .chat-section.expanded {
    flex: 100 !important;
  }

  .activity-section {
    flex: 35;
    position: relative;
    background: #000;
    transition: flex 0.35s cubic-bezier(0.4, 0, 0.2, 1), 
                opacity 0.25s ease;
    min-height: 0;
  }

  .activity-section.collapsed {
    flex: 0;
    opacity: 0;
    overflow: hidden;
  }

  /* --- LABELS (Auto-hide) --- */
  .label {
    position: absolute; 
    left: 16px; 
    top: 16px;
    background: rgba(30, 30, 30, 0.7);
    backdrop-filter: blur(12px); 
    -webkit-backdrop-filter: blur(12px);
    color: #fff; 
    padding: 6px 12px; 
    border-radius: 10px;
    font-size: 11px; 
    font-weight: 600; 
    letter-spacing: 0.5px;
    border: 1px solid rgba(255,255,255,0.08);
    pointer-events: none; 
    z-index: 10;
    display: flex; 
    align-items: center; 
    gap: 6px;
    opacity: 1;
    transition: opacity 0.4s ease;
  }

  .label.hidden {
    opacity: 0;
  }

  .dot { 
    height: 6px; width: 6px; 
    background-color: #30d158; 
    border-radius: 50%; 
    box-shadow: 0 0 6px #30d158; 
  }

  /* --- REFRESH BUTTONS (Touch-friendly) --- */
  .refresh-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 44px;
    height: 44px;
    border-radius: 22px;
    background: rgba(60, 60, 60, 0.6);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 20;
    opacity: 0;
    transition: opacity 0.3s ease, transform 0.15s ease;
    -webkit-tap-highlight-color: transparent;
  }

  .refresh-btn.visible {
    opacity: 1;
  }

  .refresh-btn:active {
    transform: scale(0.92);
    background: rgba(80, 80, 80, 0.8);
  }

  .refresh-btn svg {
    width: 20px;
    height: 20px;
    fill: rgba(255,255,255,0.8);
    transition: transform 0.3s ease;
  }

  .refresh-btn.refreshing svg {
    animation: spin 0.8s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* --- MUTE BUTTON (Above home indicator) --- */
  .mute-btn {
    position: absolute;
    bottom: calc(max(env(safe-area-inset-bottom), 8px) + 20px);
    right: 20px;
    width: 50px;
    height: 50px;
    border-radius: 25px;
    background: rgba(50, 50, 50, 0.7);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255,255,255,0.1);
    color: #fff;
    font-size: 22px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 100;
    transition: transform 0.15s ease, background 0.2s ease;
    -webkit-tap-highlight-color: transparent;
  }

  .mute-btn:active {
    transform: scale(0.92);
  }

  .mute-btn.muted {
    background: rgba(255, 59, 48, 0.3);
    border-color: rgba(255, 59, 48, 0.4);
  }

  /* --- EXPAND/COLLAPSE BUTTON --- */
  .expand-btn {
    position: absolute;
    bottom: 12px;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 28px;
    border-radius: 14px;
    background: rgba(60, 60, 60, 0.6);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 20;
    opacity: 0;
    transition: opacity 0.3s ease, transform 0.15s ease;
    -webkit-tap-highlight-color: transparent;
  }

  .expand-btn.visible {
    opacity: 1;
  }

  .expand-btn:active {
    transform: translateX(-50%) scale(0.94);
  }

  .expand-btn svg {
    width: 20px;
    height: 20px;
    fill: rgba(255,255,255,0.8);
    transition: transform 0.3s ease;
  }

  .expand-btn.expanded svg {
    transform: rotate(180deg);
  }

  /* --- ALERTS OVERLAY --- */
  .alerts-layer {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none;
    z-index: 50;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .alerts-layer iframe {
    transform: scale(0.8);
    width: 100%;
    height: 100%;
  }

  /* --- TOAST NOTIFICATION --- */
  .toast {
    position: absolute;
    top: calc(max(env(safe-area-inset-top), 12px) + 60px);
    left: 50%;
    transform: translateX(-50%) translateY(-20px);
    background: rgba(50, 50, 50, 0.9);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    color: #fff;
    padding: 10px 20px;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 500;
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    pointer-events: none;
    z-index: 200;
    border: 1px solid rgba(255,255,255,0.1);
  }

  .toast.visible {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }

  /* --- LOADING STATE --- */
  .loading-overlay {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
    transition: opacity 0.5s ease;
  }

  .loading-overlay.loaded {
    opacity: 0;
    pointer-events: none;
  }

  .loading-spinner {
    width: 28px;
    height: 28px;
    border: 3px solid rgba(255,255,255,0.1);
    border-top-color: #30d158;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  /* --- LANDSCAPE --- */
  @media (orientation: landscape) {
    .container { 
      flex-direction: row;
      padding-top: env(safe-area-inset-top);
    }
    
    .chat-section {
      flex: 70; 
      border-bottom: none;
      border-right: 1px solid rgba(255,255,255,0.1);
    }
    
    .activity-section { 
      flex: 30; 
    }

    .top-bar {
      top: env(safe-area-inset-top);
    }

    .expand-btn {
      bottom: auto;
      left: auto;
      top: 50%;
      right: 12px;
      transform: translateY(-50%);
      width: 28px;
      height: 60px;
      border-radius: 14px;
    }

    .expand-btn:active {
      transform: translateY(-50%) scale(0.94);
    }

    .expand-btn svg {
      transform: rotate(-90deg);
    }

    .expand-btn.expanded svg {
      transform: rotate(90deg);
    }

    .mute-btn {
      bottom: 20px;
      right: calc(max(env(safe-area-inset-right), 8px) + 12px);
    }

    .alerts-layer iframe {
      transform: scale(0.75);
    }
  }
</style>
</head>
<body>

  <!-- Top Bar -->
  <div class="top-bar" id="topBar">
    <div class="timer-section">
      <div class="live-indicator">
        <div class="live-dot"></div>
        <span class="live-text">LIVE</span>
      </div>
      <div class="stream-timer" id="streamTimer">00:00:00</div>
    </div>
    <div class="clock" id="clock">--:--</div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast">Chat expanded</div>

  <div class="container">
    
    <!-- Alerts Overlay -->
    <div class="alerts-layer" id="alertsLayer">
      <iframe id="alertsFrame" src="https://botrix.live/widgets/alerts/?bid=bVvmmN942GtNeeUg3AWhJg" allow="autoplay; fullscreen"></iframe>
    </div>

    <!-- Chat Section -->
    <div class="chat-section" id="chatSection">
      <div class="loading-overlay" id="chatLoading">
        <div class="loading-spinner"></div>
      </div>
      <div class="label" id="chatLabel"><div class="dot"></div> CHAT</div>
      
      <!-- Refresh Button -->
      <button class="refresh-btn" id="chatRefresh" aria-label="Refresh chat">
        <svg viewBox="0 0 24 24"><path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
      </button>
      
      <!-- Expand Button -->
      <button class="expand-btn" id="expandBtn" aria-label="Expand chat">
        <svg viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
      </button>
      
      <iframe id="chatFrame" src="https://botrix.live/widgets/chat/?bid=bVvmmN942GtNeeUg3AWhJg&bots=false&emojis=true&hideCommands=false&hideMessages=false&hideMessagesSeconds=10&widgetSize=21&trovo=false&twitch=true&youtube=true&kick=true&platformIcon=true&theme=default&ignoredUsers=&streamTogether=true&cheer=true&pointsReward=false&animation=none&showTimestamp=false&shadowThickness=1" allow="autoplay; fullscreen" onload="document.getElementById('chatLoading').classList.add('loaded')"></iframe>
    </div>

    <!-- Activity Feed Section -->
    <div class="activity-section" id="activitySection">
      <div class="loading-overlay" id="activityLoading">
        <div class="loading-spinner"></div>
      </div>
      <div class="label" id="activityLabel">ACTIVITY</div>
      
      <!-- Refresh Button -->
      <button class="refresh-btn" id="activityRefresh" aria-label="Refresh activity">
        <svg viewBox="0 0 24 24"><path d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
      </button>
      
      <iframe id="activityFrame" src="https://botrix.live/widgets/activityfeed/?bid=bVvmmN942GtNeeUg3AWhJg" allow="autoplay; fullscreen" onload="document.getElementById('activityLoading').classList.add('loaded')"></iframe>
    </div>

  </div>

  <!-- Mute Button -->
  <button class="mute-btn" id="muteBtn" aria-label="Toggle sound">ðŸ”Š</button>

<script>
  // ===== ELEMENTS =====
  const topBar = document.getElementById('topBar');
  const toast = document.getElementById('toast');
  const chatSection = document.getElementById('chatSection');
  const activitySection = document.getElementById('activitySection');
  const expandBtn = document.getElementById('expandBtn');
  const chatRefresh = document.getElementById('chatRefresh');
  const activityRefresh = document.getElementById('activityRefresh');
  const muteBtn = document.getElementById('muteBtn');
  const alertsLayer = document.getElementById('alertsLayer');

  // ===== STREAM TIMER =====
  const streamStart = Date.now();
  const streamTimerEl = document.getElementById('streamTimer');
  
  function updateStreamTimer() {
    const elapsed = Date.now() - streamStart;
    const hours = Math.floor(elapsed / 3600000);
    const minutes = Math.floor((elapsed % 3600000) / 60000);
    const seconds = Math.floor((elapsed % 60000) / 1000);
    streamTimerEl.textContent = 
      String(hours).padStart(2, '0') + ':' +
      String(minutes).padStart(2, '0') + ':' +
      String(seconds).padStart(2, '0');
  }
  setInterval(updateStreamTimer, 1000);

  // ===== CLOCK =====
  const clockEl = document.getElementById('clock');
  
  function updateClock() {
    const now = new Date();
    let hours = now.getHours();
    const ampm = hours >= 12 ? 'PM' : 'AM';
    hours = hours % 12 || 12;
    const minutes = String(now.getMinutes()).padStart(2, '0');
    clockEl.textContent = hours + ':' + minutes + ' ' + ampm;
  }
  updateClock();
  setInterval(updateClock, 1000);

  // ===== TOAST =====
  function showToast(message) {
    toast.textContent = message;
    toast.classList.add('visible');
    setTimeout(() => toast.classList.remove('visible'), 2000);
  }

  // ===== AUTO-HIDE LABELS =====
  setTimeout(() => {
    document.getElementById('chatLabel').classList.add('hidden');
    document.getElementById('activityLabel').classList.add('hidden');
  }, 4000);

  // ===== TOP BAR AUTO-HIDE =====
  let topBarTimeout;
  
  function showTopBar() {
    topBar.classList.remove('hidden');
    clearTimeout(topBarTimeout);
    topBarTimeout = setTimeout(() => topBar.classList.add('hidden'), 6000);
  }
  
  topBarTimeout = setTimeout(() => topBar.classList.add('hidden'), 6000);

  // ===== SHOW CONTROLS ON TAP =====
  let controlsVisible = false;
  let controlsTimeout;

  function showControls() {
    controlsVisible = true;
    chatRefresh.classList.add('visible');
    activityRefresh.classList.add('visible');
    expandBtn.classList.add('visible');
    showTopBar();
    
    clearTimeout(controlsTimeout);
    controlsTimeout = setTimeout(hideControls, 5000);
  }

  function hideControls() {
    controlsVisible = false;
    chatRefresh.classList.remove('visible');
    activityRefresh.classList.remove('visible');
    expandBtn.classList.remove('visible');
  }

  // Tap anywhere to toggle controls
  document.addEventListener('touchstart', (e) => {
    // Ignore if tapping a button
    if (e.target.closest('button')) return;
    
    if (controlsVisible) {
      hideControls();
    } else {
      showControls();
    }
  }, { passive: true });

  // ===== EXPAND/COLLAPSE =====
  let expanded = false;

  expandBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    expanded = !expanded;
    
    chatSection.classList.toggle('expanded', expanded);
    activitySection.classList.toggle('collapsed', expanded);
    expandBtn.classList.toggle('expanded', expanded);
    
    showToast(expanded ? 'Chat expanded' : 'Layout restored');
    
    // Keep controls visible
    clearTimeout(controlsTimeout);
    controlsTimeout = setTimeout(hideControls, 5000);
  });

  // ===== REFRESH FUNCTIONS =====
  chatRefresh.addEventListener('click', (e) => {
    e.stopPropagation();
    chatRefresh.classList.add('refreshing');
    document.getElementById('chatFrame').src = document.getElementById('chatFrame').src;
    showToast('Refreshing chat...');
    setTimeout(() => chatRefresh.classList.remove('refreshing'), 1000);
  });

  activityRefresh.addEventListener('click', (e) => {
    e.stopPropagation();
    activityRefresh.classList.add('refreshing');
    document.getElementById('activityFrame').src = document.getElementById('activityFrame').src;
    showToast('Refreshing activity...');
    setTimeout(() => activityRefresh.classList.remove('refreshing'), 1000);
  });

  // ===== MUTE TOGGLE =====
  let muted = false;

  muteBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    muted = !muted;
    muteBtn.classList.toggle('muted', muted);
    muteBtn.textContent = muted ? 'ðŸ”‡' : 'ðŸ”Š';
    alertsLayer.style.display = muted ? 'none' : 'flex';
    showToast(muted ? 'Alerts muted' : 'Alerts unmuted');
  });

  // ===== WAKE LOCK =====
  let wakeLock = null;
  
  async function requestWakeLock() {
    if ('wakeLock' in navigator) {
      try { 
        wakeLock = await navigator.wakeLock.request('screen');
      } catch (e) {}
    }
  }
  
  requestWakeLock();
  
  document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible') {
      await requestWakeLock();
    }
  });

  // ===== PREVENT ZOOM =====
  document.addEventListener('gesturestart', (e) => e.preventDefault());
  document.addEventListener('gesturechange', (e) => e.preventDefault());
  
  // Show controls hint on first load
  setTimeout(showControls, 2000);
</script>

</body>
</html>
